<html>
    <head>
        <title>TrenDJ</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
        <script>
            function printArtistID(){
                var title = document.getElementById('title').value;
                title = title.replace(" ", "%20");
                var artist = document.getElementById('artist').value;
                artist = artist.replace(" ", "%20");
                console.log(title, artist);
                var api_key = "HZT5WORGF1V4ABF99";
                var url = "https://developer.echonest.com/api/v4/song/search?api_key=HZT5WORGF1V4ABF99&format=json&results=1&artist="+ artist +"&title="+ title+"&bucket=id:spotify&bucket=tracks&limit=true"

                console.log(url);

                $.getJSON(url, function(data, status){
                    if (data.response.songs.length === 0){
                        alert("Song not found");
                        return;
                    }
                    console.log(data);
                    var trackID = data.response.songs[0].tracks[0].foreign_id;
                    //var artistID = JSON_CALLBACK.response.songs[0].artist_id;
                    console.log(trackID);
                    /*$('div.player').show()
                    url = "http://developer.echonest.com/api/v4/artist/twitter?api_key=HZT5WORGF1V4ABF99&id="+ artist_id + "&format=json"
                    $.getJSON(url).success(function(JSON_CALLBACK){
                        console.log(JSON_CALLBACK)
                    });*/
                    
                    console.log(trackID);
                    $("#spotify").attr("src","https://embed.spotify.com/?uri="+trackID);

            });
            };
        </script>
    </head>
    <body style="background: url('img/breisawesome.png') no-repeat center center; background-size:'cover' ">
        <div class="container" align="center">
            <img src="img/Twitlogo.png" height="200vh"/>
        </div>
        <div class="container">
            <div>
            <div class = "row">
                <div class="jumbotron" style="background-color: #27292B;">
                    <div class="row">
                        <div>
                            <label>
                                <input type="text"  id="title" style="width:'50vw' padding:'10px;" placeholder= "Enter song title">
                            </label>
                            <label>
                                <input type="text"  id="artist" style="width:'50vw';" placeholder="Enter artist name">
                            </label>
                        </div>
                        <div style:"valign:'middle';">
                            <button type="button" align:'center' onclick="printArtistID()"><img height="45vh"src="img/Button.jpg" type="image/tiff"/></button>
                        </div>
                    </div>
                </div>
                <div class="row">
                <div>
                        <div class="player">
                            <iframe id="spotify" src="https://embed.spotify.com/?uri=spotify:track:4th1RQAelzqgY7wL53UGQt" width="300" height="380" frameborder="0" allowtransparency="true"></iframe>
                        </div>
                    </div>
                    </div>
                <div class="jumbotron" style="background-color: #27292B; color:'red';">
                    <h1>Tweets</h1>
                        <ul>
                            <% for(var i=0; i<tweetdict.length; i++) {%>
                                    <li>
                                    <p><%= tweetdict[i].tweetsname %></p>
                                    <img src=<%= tweetdict[i].profilepic %>>
                                    <blockquote class="tweet"><%= tweetdict[i].tweettext %>
                                    </li>
                            <% } %>
                        </ul>
                    <div class="tweet">
                        <img id="twitterPic" src="">
                        <blockquote> </blockquote>
                    </div>
                </div>
            </div>
            </div>
        </div>
    </body>
</html>
